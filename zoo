import os
from peewee import *
from flask import Flask, json, jsonify
from playhouse.shortcuts import model_to_dict

arq = 'many−to−many−com−lista.db'
db = SqliteDatabase (arq)

class BaseModel(Model):
    class Meta:
        database = db

class Alimentos(BaseModel):
    nome = CharField()
    quantidade = CharField()
    tipo_alimentacao_do_animal = CharField() 

class Animais(BaseModel):
    especie = CharField()
    nome = CharField()
    idade = CharField()
    sexo = CharField()
    alimento = ForeignKeyField(Alimentos)

class Funcionario(BaseModel):
    nome = CharField()
    cargo = CharField()
    cpf = CharField()
    turno = CharField()

class Setores(BaseModel):
    nome = CharField()
    localizacao = CharField()
    animais = ForeignKeyField(Animais)
    tipo_setor = CharField()

class Visitantes(BaseModel):
    nome = CharField()
    idade = IntegerField()
    cpf = CharField()

class Ingresso(BaseModel):
    preco = FloatField()
    cod_ingresso = CharField()
    visitantes = ForeignKeyField(Visitantes)

class Bilheteria(BaseModel):
    localizacao = CharField()
    ingresso = ForeignKeyField(Ingresso)

class Produtos(BaseModel):
    tipo_produto = CharField()
    cod_indentificador = IntegerField()
    quantidade = IntegerField()

class Estoque(BaseModel):
    alimentacao = ForeignKeyField(Alimentos)
    produto = ForeignKeyField(Produtos)
    fornecedor = CharField()

class Zoologico(BaseModel):
    nome = CharField()
    setor = ForeignKeyField(Setores)
    funcionarios = ForeignKeyField(Funcionario)


if __name__ == "__main__":
    db.connect()
    db.create_tables([Alimentos, Animais, Funcionario, Setores, Visitantes, Ingresso, Bilheteria, Produtos, Estoque, Zoologico])

    
    alimento1 = Alimentos.create(nome = "amora" , quantidade = "44 quilos" , tipo_alimentacao_do_animal = "herbívoro" )
    animal1 = Animais.create(especie = "girafa", nome = "Gigi", idade = "4 anos", sexo = "feminino", alimento = alimento1)
    funcionario1 = Funcionario.create(nome = "Joaquim Menezes", cargo = "Veterinário", cpf = "02304202302", turno = "matutino")
    setor1 = Setores.create(nome = "Savana", localizacao = "sul", animais = animal1, tipo_setor = "terrestre")
    visitante1 = Visitantes.create(nome = "Juliana Paes", idade = 42, cpf = "02302502404")
    ingresso1 = Ingresso.create
    json = list(map(model_to_dict, Alimentos.select()))

    print(json)

    {
        "zoologico" : {
            "nome" : "meu zoo",
            "setor" : {
                
            }
        }
    }
